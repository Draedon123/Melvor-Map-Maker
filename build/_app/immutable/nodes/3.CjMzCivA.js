import{a as z,j as Z,o as se,C as Y,d as V,r as ue,F as fe,c as ne,e as ee,u as ae,g as le,b as re,G as pe,l as ce,H as me}from"../chunks/scheduler.DafV1NiC.js";import{S as O,i as W,c as k,d as H,m as L,t as y,l as N,n as P,e as D,s as A,a as E,b as j,q as F,f as M,g as w,h as m,j as S,k as v,r as Q,D as de,B as U,o as B,p as q,x as $e}from"../chunks/index.CBrhJNql.js";import{b as G}from"../chunks/paths.NSKnbFwK.js";import{D as oe}from"../chunks/Dialog.CR1BSCdg.js";import{s as X,S as ge}from"../chunks/store.DR8vj8vw.js";import{T as he,a as te}from"../chunks/ToolbarItem.BMDZt-Z2.js";import{a as _e,b as ve}from"../chunks/imageUtils.DqB4fmTZ.js";import{D as be,P as xe}from"../chunks/DragDropUpload.D50gPBm0.js";import{w as Ce}from"../chunks/index.3LXDjCI8.js";function Te(r){let e,t,a="Hex Count",s,n,l,p,u="X:",f,i,o,R,h,I,$,c="Y:",x,_,b,C,d;return{c(){e=D("div"),t=D("h1"),t.textContent=a,s=A(),n=D("br"),l=A(),p=D("label"),p.textContent=u,f=A(),i=D("input"),R=A(),h=D("br"),I=A(),$=D("label"),$.textContent=c,x=A(),_=D("input"),this.h()},l(g){e=E(g,"DIV",{class:!0});var T=j(e);t=E(T,"H1",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-c4bxn4"&&(t.textContent=a),s=M(T),n=E(T,"BR",{class:!0}),l=M(T),p=E(T,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),F(p)!=="svelte-vvw4xn"&&(p.textContent=u),f=M(T),i=E(T,"INPUT",{id:!0,name:!0,type:!0,min:!0,step:!0,class:!0}),R=M(T),h=E(T,"BR",{class:!0}),I=M(T),$=E(T,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),F($)!=="svelte-tr29dr"&&($.textContent=c),x=M(T),_=E(T,"INPUT",{id:!0,name:!0,type:!0,min:!0,step:!0,class:!0}),T.forEach(w),this.h()},h(){m(t,"class","svelte-m378fu"),m(n,"class","svelte-m378fu"),m(p,"for","hexesX"),m(p,"class","svelte-m378fu"),m(i,"id","hexesX"),m(i,"name","hexesX"),m(i,"type","number"),m(i,"min",1),m(i,"step",1),i.value=o=r[1].hexesX,m(i,"class","svelte-m378fu"),m(h,"class","svelte-m378fu"),m($,"for","hexesY"),m($,"class","svelte-m378fu"),m(_,"id","hexesY"),m(_,"name","hexesY"),m(_,"type","number"),m(_,"min",1),m(_,"step",1),_.value=b=r[1].hexesY,m(_,"class","svelte-m378fu"),m(e,"class","dialog svelte-m378fu")},m(g,T){S(g,e,T),v(e,t),v(e,s),v(e,n),v(e,l),v(e,p),v(e,f),v(e,i),v(e,R),v(e,h),v(e,I),v(e,$),v(e,x),v(e,_),C||(d=[Q(i,"change",r[3]),Q(_,"change",r[4])],C=!0)},p(g,T){T&2&&o!==(o=g[1].hexesX)&&i.value!==o&&(i.value=o),T&2&&b!==(b=g[1].hexesY)&&_.value!==b&&(_.value=b)},d(g){g&&w(e),C=!1,ue(d)}}}function we(r){let e,t,a={$$slots:{default:[Te]},$$scope:{ctx:r}};return e=new oe({props:a}),r[5](e),{c(){k(e.$$.fragment)},l(s){H(e.$$.fragment,s)},m(s,n){L(e,s,n),t=!0},p(s,[n]){const l={};n&130&&(l.$$scope={dirty:n,ctx:s}),e.$set(l)},i(s){t||(y(e.$$.fragment,s),t=!0)},o(s){N(e.$$.fragment,s),t=!1},d(s){r[5](null),P(e,s)}}}function Ie(r,e,t){let a;Z(r,X,i=>t(1,a=i));const s={modal:null};let n;const l={x:a.hexesX,y:a.hexesY};X.subscribe(({hexesX:i,hexesY:o})=>{a.viewport===null||l.x===i&&l.y===o||a.hexGridLayer.populate(a.mapDimensions,a.viewport,i,o)}),se(()=>{t(2,s.modal=n,s)});const p=i=>{const o=parseInt(i.currentTarget.value);Y(X,a.hexesX=isNaN(o)?1:Math.max(Math.floor(o),1),a)},u=i=>{const o=parseInt(i.currentTarget.value);Y(X,a.hexesY=isNaN(o)?1:Math.max(Math.floor(o),1),a)};function f(i){V[i?"unshift":"push"](()=>{n=i,t(0,n)})}return[n,a,s,p,u,f]}class De extends O{constructor(e){super(),W(this,e,Ie,we,z,{exports:2})}get exports(){return this.$$.ctx[2]}}function Ee(r){let e,t=`Drag and drop your .basis files here (in 1 go), or click to upload a
        file.`,a,s,n;return{c(){e=D("p"),e.textContent=t,a=A(),s=D("span"),n=B(r[1]),this.h()},l(l){e=E(l,"P",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-1isbihn"&&(e.textContent=t),a=M(l),s=E(l,"SPAN",{class:!0});var p=j(s);n=q(p,r[1]),p.forEach(w),this.h()},h(){m(e,"class","svelte-13jdnn1"),m(s,"class","error svelte-13jdnn1")},m(l,p){S(l,e,p),S(l,a,p),S(l,s,p),v(s,n)},p(l,p){p&2&&$e(n,l[1])},d(l){l&&(w(e),w(a),w(s))}}}function Ae(r){let e,t,a="Upload Map Images",s,n,l="The map images must be in the format: tile_(x)_(y)@(1x OR 0.5x).basis",p,u,f="ie, tile_3_5@0.5x.basis",i,o,R,h,I,$,c;o=new be({props:{mimeType:".basis",multiple:!0,onFileUpload:r[4],$$slots:{default:[Ee]},$$scope:{ctx:r}}});function x(b){r[6](b)}let _={containerStyles:{"border-color":"red"}};return r[2]!==void 0&&(_.value=r[2]),I=new xe({props:_}),V.push(()=>de(I,"value",x)),r[7](I),{c(){e=D("div"),t=D("h1"),t.textContent=a,s=A(),n=D("p"),n.textContent=l,p=A(),u=D("p"),u.textContent=f,i=A(),k(o.$$.fragment),R=A(),h=D("div"),k(I.$$.fragment),this.h()},l(b){e=E(b,"DIV",{class:!0});var C=j(e);t=E(C,"H1",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-d8o6tz"&&(t.textContent=a),s=M(C),n=E(C,"P",{class:!0,"data-svelte-h":!0}),F(n)!=="svelte-lya26t"&&(n.textContent=l),p=M(C),u=E(C,"P",{class:!0,"data-svelte-h":!0}),F(u)!=="svelte-1gtbz8v"&&(u.textContent=f),i=M(C),H(o.$$.fragment,C),R=M(C),h=E(C,"DIV",{class:!0});var d=j(h);H(I.$$.fragment,d),d.forEach(w),C.forEach(w),this.h()},h(){m(t,"class","svelte-13jdnn1"),m(n,"class","svelte-13jdnn1"),m(u,"class","svelte-13jdnn1"),m(h,"class","progress-bar svelte-13jdnn1"),U(h,"hidden",r[2]===0),m(e,"class","dialog svelte-13jdnn1")},m(b,C){S(b,e,C),v(e,t),v(e,s),v(e,n),v(e,p),v(e,u),v(e,i),L(o,e,null),v(e,R),v(e,h),L(I,h,null),c=!0},p(b,C){const d={};C&1026&&(d.$$scope={dirty:C,ctx:b}),o.$set(d);const g={};!$&&C&4&&($=!0,g.value=b[2],fe(()=>$=!1)),I.$set(g),(!c||C&4)&&U(h,"hidden",b[2]===0)},i(b){c||(y(o.$$.fragment,b),y(I.$$.fragment,b),c=!0)},o(b){N(o.$$.fragment,b),N(I.$$.fragment,b),c=!1},d(b){b&&w(e),P(o),r[7](null),P(I)}}}function Me(r){let e,t,a={$$slots:{default:[Ae]},$$scope:{ctx:r}};return e=new oe({props:a}),r[8](e),{c(){k(e.$$.fragment)},l(s){H(e.$$.fragment,s)},m(s,n){L(e,s,n),t=!0},p(s,[n]){const l={};n&1038&&(l.$$scope={dirty:n,ctx:s}),e.$set(l)},i(s){t||(y(e.$$.fragment,s),t=!0)},o(s){N(e.$$.fragment,s),t=!1},d(s){r[8](null),P(e,s)}}}const Se=/^tile_\d+_\d+@(1|0.5)x\.basis$/;function ye(r,e,t){let a;Z(r,X,h=>t(9,a=h));const s={modal:null};let n,l="",p=0,u;async function f(h){var C;if(t(1,l=""),a.viewport===null){t(1,l="Error: App is not initialised. This shouldn't happen...");return}if(h.length===0)return;const I=(C=h.find(d=>!Se.test(d.name)))==null?void 0:C.name;if(I!==void 0){t(1,l=`Invalid file name: ${I}`);return}const $=h.map(d=>{const g=d.name.slice(0,-7).split(/_|@/g),T=parseInt(g[1]),J=parseInt(g[2]),ie=parseInt(g[3]);return{x:T,y:J,resolution:ie}}),c=Math.max(...$.map(d=>d.x))+1,x=Math.max(...$.map(d=>d.y))+1;if($.length!==c*x){const d=[];for(let g=0;g<c;g++)for(let T=0;T<x;T++)$.find(J=>J.x===g&&J.y===T)===void 0&&d.push({x:g,y:T});t(1,l=`Some tiles are missing. First, do you intend to have ${c}x${x} tiles? If so, then you are missing these tiles: ${d.map(g=>`(${g.x},${g.y})`).join(", ")}`);return}const _=await _e(h.map(d=>({file:d,name:d.name})),2,d=>{u.set(d)});Y(X,a.mapDimensions={x:_.tileWidth*c,y:_.tileHeight*x},a);const b=_.tiles.map(d=>{const g=ge.from(ve(d.image));return g.x=d.x*_.tileWidth,g.y=d.y*_.tileHeight,g.cullable=!0,g.label=`Tile (${d.x}, ${d.y})`,g});a.viewport.children.forEach(d=>d.removeChildren().forEach(g=>g.destroy)),a.backgroundLayer.addChild(...b),Y(X,a.viewport.worldWidth=a.mapDimensions.x,a),Y(X,a.viewport.worldHeight=a.mapDimensions.y,a),a.viewport.centerViewport(),a.hexGridLayer.populate(a.mapDimensions,a.viewport,a.hexesX,a.hexesY)}se(()=>{t(5,s.modal=n,s)});function i(h){p=h,t(2,p)}function o(h){V[h?"unshift":"push"](()=>{u=h,t(3,u)})}function R(h){V[h?"unshift":"push"](()=>{n=h,t(0,n)})}return[n,l,p,u,f,s,i,o,R]}class Ne extends O{constructor(e){super(),W(this,e,ye,Me,z,{exports:5})}get exports(){return this.$$.ctx[5]}}function Re(r){let e,t,a,s,n,l,p;const u=r[7].default,f=ne(u,r,r[6],null);return{c(){e=D("input"),a=A(),s=D("div"),f&&f.c(),this.h()},l(i){e=E(i,"INPUT",{type:!0,src:!0,alt:!0,class:!0}),a=M(i),s=E(i,"DIV",{class:!0});var o=j(s);f&&f.l(o),o.forEach(w),this.h()},h(){m(e,"type","image"),ee(e.src,t=r[0])||m(e,"src",t),m(e,"alt",r[1]),m(e,"class","svelte-q18i79"),U(e,"active",r[2]===r[3]),m(s,"class","svelte-q18i79"),U(s,"hidden",r[2]!==r[3])},m(i,o){S(i,e,o),S(i,a,o),S(i,s,o),f&&f.m(s,null),n=!0,l||(p=Q(e,"click",r[5]),l=!0)},p(i,[o]){(!n||o&1&&!ee(e.src,t=i[0]))&&m(e,"src",t),(!n||o&2)&&m(e,"alt",i[1]),(!n||o&12)&&U(e,"active",i[2]===i[3]),f&&f.p&&(!n||o&64)&&ae(f,u,i,i[6],n?re(u,i[6],o,null):le(i[6]),null),(!n||o&12)&&U(s,"hidden",i[2]!==i[3])},i(i){n||(y(f,i),n=!0)},o(i){N(f,i),n=!1},d(i){i&&(w(e),w(a),w(s)),f&&f.d(i),l=!1,p()}}}let ke=0;function He(){return ke++}function Le(r,e,t){let a,{$$slots:s={},$$scope:n}=e,{imageSRC:l}=e,{imageAltText:p}=e;const u=He(),f=pe("propertiesMenu").activeTab;Z(r,f,o=>t(3,a=o));function i(){Y(f,a=u,a)}return r.$$set=o=>{"imageSRC"in o&&t(0,l=o.imageSRC),"imageAltText"in o&&t(1,p=o.imageAltText),"$$scope"in o&&t(6,n=o.$$scope)},[l,p,u,a,f,i,n,s]}class K extends O{constructor(e){super(),W(this,e,Le,Re,z,{imageSRC:0,imageAltText:1,id:2})}get id(){return this.$$.ctx[2]}}function Pe(r){let e;return{c(){e=B("1")},l(t){e=q(t,"1")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function Ue(r){let e;return{c(){e=B("2")},l(t){e=q(t,"2")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function Xe(r){let e;return{c(){e=B("3")},l(t){e=q(t,"3")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function je(r){let e,t,a,s,n,l,p;return t=new K({props:{imageSRC:G+"/hex_grid.png",imageAltText:"",$$slots:{default:[Pe]},$$scope:{ctx:r}}}),s=new K({props:{imageSRC:G+"/hex_grid.png",imageAltText:"",$$slots:{default:[Ue]},$$scope:{ctx:r}}}),l=new K({props:{imageSRC:G+"/hex_grid.png",imageAltText:"",$$slots:{default:[Xe]},$$scope:{ctx:r}}}),{c(){e=D("div"),k(t.$$.fragment),a=A(),k(s.$$.fragment),n=A(),k(l.$$.fragment),this.h()},l(u){e=E(u,"DIV",{class:!0});var f=j(e);H(t.$$.fragment,f),a=M(f),H(s.$$.fragment,f),n=M(f),H(l.$$.fragment,f),f.forEach(w),this.h()},h(){m(e,"class","container svelte-1tcz0e6"),U(e,"hidden",r[0])},m(u,f){S(u,e,f),L(t,e,null),v(e,a),L(s,e,null),v(e,n),L(l,e,null),r[2](e),p=!0},p(u,[f]){const i={};f&8&&(i.$$scope={dirty:f,ctx:u}),t.$set(i);const o={};f&8&&(o.$$scope={dirty:f,ctx:u}),s.$set(o);const R={};f&8&&(R.$$scope={dirty:f,ctx:u}),l.$set(R),(!p||f&1)&&U(e,"hidden",u[0])},i(u){p||(y(t.$$.fragment,u),y(s.$$.fragment,u),y(l.$$.fragment,u),p=!0)},o(u){N(t.$$.fragment,u),N(s.$$.fragment,u),N(l.$$.fragment,u),p=!1},d(u){u&&w(e),P(t),P(s),P(l),r[2](null)}}}const Fe={activeTab:Ce(0)};function Ve(r,e,t){let{hidden:a=!1}=e,s;me("propertiesMenu",Fe);function n(l){V[l?"unshift":"push"](()=>{s=l,t(1,s)})}return r.$$set=l=>{"hidden"in l&&t(0,a=l.hidden)},[a,s,n]}class Ye extends O{constructor(e){super(),W(this,e,Ve,je,z,{hidden:0})}get hidden(){return this.$$.ctx[0]}set hidden(e){this.$$set({hidden:e}),ce()}}function Be(r){let e;return{c(){e=B("Upload Map Images")},l(t){e=q(t,"Upload Map Images")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function qe(r){let e;return{c(){e=B("Hexes")},l(t){e=q(t,"Hexes")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function Ge(r){let e,t,a,s;return e=new te({props:{imageSRC:G+"/upload.png",imageAltText:"An upload icon",onClick:r[3],$$slots:{default:[Be]},$$scope:{ctx:r}}}),a=new te({props:{imageSRC:G+"/hex_grid.png",imageAltText:"A honeycomb",onClick:r[4],$$slots:{default:[qe]},$$scope:{ctx:r}}}),{c(){k(e.$$.fragment),t=A(),k(a.$$.fragment)},l(n){H(e.$$.fragment,n),t=M(n),H(a.$$.fragment,n)},m(n,l){L(e,n,l),S(n,t,l),L(a,n,l),s=!0},p(n,l){const p={};l&1&&(p.onClick=n[3]),l&128&&(p.$$scope={dirty:l,ctx:n}),e.$set(p);const u={};l&2&&(u.onClick=n[4]),l&128&&(u.$$scope={dirty:l,ctx:n}),a.$set(u)},i(n){s||(y(e.$$.fragment,n),y(a.$$.fragment,n),s=!0)},o(n){N(e.$$.fragment,n),N(a.$$.fragment,n),s=!1},d(n){n&&w(t),P(e,n),P(a,n)}}}function ze(r){let e,t,a,s,n,l,p,u,f,i,o;t=new he({props:{$$slots:{default:[Ge]},$$scope:{ctx:r}}});let R={};s=new Ne({props:R}),r[5](s);let h={};l=new De({props:h}),r[6](l);const I=r[2].default,$=ne(I,r,r[7],null);return i=new Ye({}),{c(){e=D("div"),k(t.$$.fragment),a=A(),k(s.$$.fragment),n=A(),k(l.$$.fragment),p=A(),u=D("div"),$&&$.c(),f=A(),k(i.$$.fragment),this.h()},l(c){e=E(c,"DIV",{class:!0});var x=j(e);H(t.$$.fragment,x),a=M(x),H(s.$$.fragment,x),n=M(x),H(l.$$.fragment,x),p=M(x),u=E(x,"DIV",{class:!0});var _=j(u);$&&$.l(_),f=M(_),H(i.$$.fragment,_),_.forEach(w),x.forEach(w),this.h()},h(){m(u,"class","main svelte-piryt3"),m(e,"class","container svelte-piryt3")},m(c,x){S(c,e,x),L(t,e,null),v(e,a),L(s,e,null),v(e,n),L(l,e,null),v(e,p),v(e,u),$&&$.m(u,null),v(u,f),L(i,u,null),o=!0},p(c,[x]){const _={};x&131&&(_.$$scope={dirty:x,ctx:c}),t.$set(_);const b={};s.$set(b);const C={};l.$set(C),$&&$.p&&(!o||x&128)&&ae($,I,c,c[7],o?re(I,c[7],x,null):le(c[7]),null)},i(c){o||(y(t.$$.fragment,c),y(s.$$.fragment,c),y(l.$$.fragment,c),y($,c),y(i.$$.fragment,c),o=!0)},o(c){N(t.$$.fragment,c),N(s.$$.fragment,c),N(l.$$.fragment,c),N($,c),N(i.$$.fragment,c),o=!1},d(c){c&&w(e),P(t),r[5](null),P(s),r[6](null),P(l),$&&$.d(c),P(i)}}}function Oe(r,e,t){let{$$slots:a={},$$scope:s}=e,n,l;const p=()=>{var o;(o=n.exports.modal)==null||o.toggle()},u=()=>{var o;(o=l.exports.modal)==null||o.toggle()};function f(o){V[o?"unshift":"push"](()=>{n=o,t(0,n)})}function i(o){V[o?"unshift":"push"](()=>{l=o,t(1,l)})}return r.$$set=o=>{"$$scope"in o&&t(7,s=o.$$scope)},[n,l,a,p,u,f,i,s]}class at extends O{constructor(e){super(),W(this,e,Oe,ze,z,{})}}export{at as component};
