import{a as G,j as ee,o as te,C as F,d as Y,r as ae,D as re,l as le,n as J,c as oe,u as ie,g as ue,b as pe}from"../chunks/scheduler.wtKEThmD.js";import{S as W,i as q,c as A,d as N,m as P,t as L,l as j,n as X,e as y,s as T,a as I,b as B,q as U,f as M,g as E,h as $,j as k,k as v,r as K,B as fe,C as R,o as z,p as O,x as me}from"../chunks/index.Ba8SPs6y.js";import{b as Q}from"../chunks/paths.BWy_JArI.js";import{D as se}from"../chunks/Dialog.B8SOHUYu.js";import{s as S,S as ce}from"../chunks/store.TLjOzG5A.js";import{T as de,a as Z}from"../chunks/ToolbarItem.CRFI5oac.js";import{a as he,b as ge}from"../chunks/imageUtils.CRgvKi6f.js";import{D as $e,P as _e}from"../chunks/DragDropUpload.BG80fNuk.js";function ve(l){let e,t,s="Hex Count",n,a,r,p,f="X:",D,i,o,H,h,w,c,u="Y:",b,g,_,x,m;return{c(){e=y("div"),t=y("h1"),t.textContent=s,n=T(),a=y("br"),r=T(),p=y("label"),p.textContent=f,D=T(),i=y("input"),H=T(),h=y("br"),w=T(),c=y("label"),c.textContent=u,b=T(),g=y("input"),this.h()},l(d){e=I(d,"DIV",{class:!0});var C=B(e);t=I(C,"H1",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-c4bxn4"&&(t.textContent=s),n=M(C),a=I(C,"BR",{class:!0}),r=M(C),p=I(C,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),U(p)!=="svelte-vvw4xn"&&(p.textContent=f),D=M(C),i=I(C,"INPUT",{id:!0,name:!0,type:!0,min:!0,step:!0,class:!0}),H=M(C),h=I(C,"BR",{class:!0}),w=M(C),c=I(C,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),U(c)!=="svelte-tr29dr"&&(c.textContent=u),b=M(C),g=I(C,"INPUT",{id:!0,name:!0,type:!0,min:!0,step:!0,class:!0}),C.forEach(E),this.h()},h(){$(t,"class","svelte-m378fu"),$(a,"class","svelte-m378fu"),$(p,"for","hexesX"),$(p,"class","svelte-m378fu"),$(i,"id","hexesX"),$(i,"name","hexesX"),$(i,"type","number"),$(i,"min",1),$(i,"step",1),i.value=o=l[1].hexesX,$(i,"class","svelte-m378fu"),$(h,"class","svelte-m378fu"),$(c,"for","hexesY"),$(c,"class","svelte-m378fu"),$(g,"id","hexesY"),$(g,"name","hexesY"),$(g,"type","number"),$(g,"min",1),$(g,"step",1),g.value=_=l[1].hexesY,$(g,"class","svelte-m378fu"),$(e,"class","dialog svelte-m378fu")},m(d,C){k(d,e,C),v(e,t),v(e,n),v(e,a),v(e,r),v(e,p),v(e,D),v(e,i),v(e,H),v(e,h),v(e,w),v(e,c),v(e,b),v(e,g),x||(m=[K(i,"change",l[3]),K(g,"change",l[4])],x=!0)},p(d,C){C&2&&o!==(o=d[1].hexesX)&&i.value!==o&&(i.value=o),C&2&&_!==(_=d[1].hexesY)&&g.value!==_&&(g.value=_)},d(d){d&&E(e),x=!1,ae(m)}}}function be(l){let e,t,s={$$slots:{default:[ve]},$$scope:{ctx:l}};return e=new se({props:s}),l[5](e),{c(){A(e.$$.fragment)},l(n){N(e.$$.fragment,n)},m(n,a){P(e,n,a),t=!0},p(n,[a]){const r={};a&130&&(r.$$scope={dirty:a,ctx:n}),e.$set(r)},i(n){t||(L(e.$$.fragment,n),t=!0)},o(n){j(e.$$.fragment,n),t=!1},d(n){l[5](null),X(e,n)}}}function xe(l,e,t){let s;ee(l,S,i=>t(1,s=i));const n={modal:null};let a;const r={x:s.hexesX,y:s.hexesY};S.subscribe(({hexesX:i,hexesY:o})=>{s.viewport===null||r.x===i&&r.y===o||s.hexGridLayer.populate(s.mapDimensions,s.viewport,i,o)}),te(()=>{t(2,n.modal=a,n)});const p=i=>{const o=parseInt(i.currentTarget.value);F(S,s.hexesX=isNaN(o)?1:Math.max(Math.floor(o),1),s)},f=i=>{const o=parseInt(i.currentTarget.value);F(S,s.hexesY=isNaN(o)?1:Math.max(Math.floor(o),1),s)};function D(i){Y[i?"unshift":"push"](()=>{a=i,t(0,a)})}return[a,s,n,p,f,D]}class Ce extends W{constructor(e){super(),q(this,e,xe,be,G,{exports:2})}get exports(){return this.$$.ctx[2]}}function we(l){let e,t=`Drag and drop your .basis files here (in 1 go), or click to upload a
        file.`,s,n,a;return{c(){e=y("p"),e.textContent=t,s=T(),n=y("span"),a=z(l[1]),this.h()},l(r){e=I(r,"P",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1isbihn"&&(e.textContent=t),s=M(r),n=I(r,"SPAN",{class:!0});var p=B(n);a=O(p,l[1]),p.forEach(E),this.h()},h(){$(e,"class","svelte-13jdnn1"),$(n,"class","error svelte-13jdnn1")},m(r,p){k(r,e,p),k(r,s,p),k(r,n,p),v(n,a)},p(r,p){p&2&&me(a,r[1])},d(r){r&&(E(e),E(s),E(n))}}}function ye(l){let e,t,s="Upload Map Images",n,a,r="The map images must be in the format: tile_(x)_(y)@(1x OR 0.5x).basis",p,f,D="ie, tile_3_5@0.5x.basis",i,o,H,h,w,c,u;o=new $e({props:{mimeType:".basis",multiple:!0,onFileUpload:l[4],$$slots:{default:[we]},$$scope:{ctx:l}}});function b(_){l[6](_)}let g={containerStyles:{"border-color":"red"}};return l[2]!==void 0&&(g.value=l[2]),w=new _e({props:g}),Y.push(()=>fe(w,"value",b)),l[7](w),{c(){e=y("div"),t=y("h1"),t.textContent=s,n=T(),a=y("p"),a.textContent=r,p=T(),f=y("p"),f.textContent=D,i=T(),A(o.$$.fragment),H=T(),h=y("div"),A(w.$$.fragment),this.h()},l(_){e=I(_,"DIV",{class:!0});var x=B(e);t=I(x,"H1",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-d8o6tz"&&(t.textContent=s),n=M(x),a=I(x,"P",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-lya26t"&&(a.textContent=r),p=M(x),f=I(x,"P",{class:!0,"data-svelte-h":!0}),U(f)!=="svelte-1gtbz8v"&&(f.textContent=D),i=M(x),N(o.$$.fragment,x),H=M(x),h=I(x,"DIV",{class:!0});var m=B(h);N(w.$$.fragment,m),m.forEach(E),x.forEach(E),this.h()},h(){$(t,"class","svelte-13jdnn1"),$(a,"class","svelte-13jdnn1"),$(f,"class","svelte-13jdnn1"),$(h,"class","progress-bar svelte-13jdnn1"),R(h,"hidden",l[2]===0),$(e,"class","dialog svelte-13jdnn1")},m(_,x){k(_,e,x),v(e,t),v(e,n),v(e,a),v(e,p),v(e,f),v(e,i),P(o,e,null),v(e,H),v(e,h),P(w,h,null),u=!0},p(_,x){const m={};x&1026&&(m.$$scope={dirty:x,ctx:_}),o.$set(m);const d={};!c&&x&4&&(c=!0,d.value=_[2],re(()=>c=!1)),w.$set(d),(!u||x&4)&&R(h,"hidden",_[2]===0)},i(_){u||(L(o.$$.fragment,_),L(w.$$.fragment,_),u=!0)},o(_){j(o.$$.fragment,_),j(w.$$.fragment,_),u=!1},d(_){_&&E(e),X(o),l[7](null),X(w)}}}function Ie(l){let e,t,s={$$slots:{default:[ye]},$$scope:{ctx:l}};return e=new se({props:s}),l[8](e),{c(){A(e.$$.fragment)},l(n){N(e.$$.fragment,n)},m(n,a){P(e,n,a),t=!0},p(n,[a]){const r={};a&1038&&(r.$$scope={dirty:a,ctx:n}),e.$set(r)},i(n){t||(L(e.$$.fragment,n),t=!0)},o(n){j(e.$$.fragment,n),t=!1},d(n){l[8](null),X(e,n)}}}const De=/^tile_\d+_\d+@(1|0.5)x\.basis$/;function Te(l,e,t){let s;ee(l,S,h=>t(9,s=h));const n={modal:null};let a,r="",p=0,f;async function D(h){var x;if(t(1,r=""),s.viewport===null){t(1,r="Error: App is not initialised. This shouldn't happen...");return}if(h.length===0)return;const w=(x=h.find(m=>!De.test(m.name)))==null?void 0:x.name;if(w!==void 0){t(1,r=`Invalid file name: ${w}`);return}const c=h.map(m=>{const d=m.name.slice(0,-7).split(/_|@/g),C=parseInt(d[1]),V=parseInt(d[2]),ne=parseInt(d[3]);return{x:C,y:V,resolution:ne}}),u=Math.max(...c.map(m=>m.x))+1,b=Math.max(...c.map(m=>m.y))+1;if(c.length!==u*b){const m=[];for(let d=0;d<u;d++)for(let C=0;C<b;C++)c.find(V=>V.x===d&&V.y===C)===void 0&&m.push({x:d,y:C});t(1,r=`Some tiles are missing. First, do you intend to have ${u}x${b} tiles? If so, then you are missing these tiles: ${m.map(d=>`(${d.x},${d.y})`).join(", ")}`);return}const g=await he(h.map(m=>({file:m,name:m.name})),2,m=>{f.set(m)});F(S,s.mapDimensions={x:g.tileWidth*u,y:g.tileHeight*b},s);const _=g.tiles.map(m=>{const d=ce.from(ge(m.image));return d.x=m.x*g.tileWidth,d.y=m.y*g.tileHeight,d.cullable=!0,d.label=`Tile (${m.x}, ${m.y})`,d});s.viewport.children.forEach(m=>m.removeChildren().forEach(d=>d.destroy)),s.backgroundLayer.addChild(..._),F(S,s.viewport.worldWidth=s.mapDimensions.x,s),F(S,s.viewport.worldHeight=s.mapDimensions.y,s),s.viewport.centerViewport(),s.hexGridLayer.populate(s.mapDimensions,s.viewport,s.hexesX,s.hexesY)}te(()=>{t(5,n.modal=a,n)});function i(h){p=h,t(2,p)}function o(h){Y[h?"unshift":"push"](()=>{f=h,t(3,f)})}function H(h){Y[h?"unshift":"push"](()=>{a=h,t(0,a)})}return[a,r,p,f,D,n,i,o,H]}class Me extends W{constructor(e){super(),q(this,e,Te,Ie,G,{exports:5})}get exports(){return this.$$.ctx[5]}}function Ee(l){let e,t="asd <br/>";return{c(){e=y("div"),e.innerHTML=t,this.h()},l(s){e=I(s,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-xjlaim"&&(e.innerHTML=t),this.h()},h(){$(e,"class","container svelte-ugsehg"),R(e,"hidden",l[0])},m(s,n){k(s,e,n),l[2](e)},p(s,[n]){n&1&&R(e,"hidden",s[0])},i:J,o:J,d(s){s&&E(e),l[2](null)}}}function He(l,e,t){let{hidden:s=!1}=e,n;function a(r){Y[r?"unshift":"push"](()=>{n=r,t(1,n)})}return l.$$set=r=>{"hidden"in r&&t(0,s=r.hidden)},[s,n,a]}class Le extends W{constructor(e){super(),q(this,e,He,Ee,G,{hidden:0})}get hidden(){return this.$$.ctx[0]}set hidden(e){this.$$set({hidden:e}),le()}}function je(l){let e;return{c(){e=z("Upload Map Images")},l(t){e=O(t,"Upload Map Images")},m(t,s){k(t,e,s)},d(t){t&&E(e)}}}function Ae(l){let e;return{c(){e=z("Hexes")},l(t){e=O(t,"Hexes")},m(t,s){k(t,e,s)},d(t){t&&E(e)}}}function Ne(l){let e,t,s,n;return e=new Z({props:{imageSRC:Q+"/upload.png",imageAltText:"An upload icon",onClick:l[3],$$slots:{default:[je]},$$scope:{ctx:l}}}),s=new Z({props:{imageSRC:Q+"/hex_grid.png",imageAltText:"A honeycomb",onClick:l[4],$$slots:{default:[Ae]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment),t=T(),A(s.$$.fragment)},l(a){N(e.$$.fragment,a),t=M(a),N(s.$$.fragment,a)},m(a,r){P(e,a,r),k(a,t,r),P(s,a,r),n=!0},p(a,r){const p={};r&1&&(p.onClick=a[3]),r&128&&(p.$$scope={dirty:r,ctx:a}),e.$set(p);const f={};r&2&&(f.onClick=a[4]),r&128&&(f.$$scope={dirty:r,ctx:a}),s.$set(f)},i(a){n||(L(e.$$.fragment,a),L(s.$$.fragment,a),n=!0)},o(a){j(e.$$.fragment,a),j(s.$$.fragment,a),n=!1},d(a){a&&E(t),X(e,a),X(s,a)}}}function Pe(l){let e,t,s,n,a,r,p,f,D,i,o;t=new de({props:{$$slots:{default:[Ne]},$$scope:{ctx:l}}});let H={};n=new Me({props:H}),l[5](n);let h={};r=new Ce({props:h}),l[6](r);const w=l[2].default,c=oe(w,l,l[7],null);return i=new Le({}),{c(){e=y("div"),A(t.$$.fragment),s=T(),A(n.$$.fragment),a=T(),A(r.$$.fragment),p=T(),f=y("div"),c&&c.c(),D=T(),A(i.$$.fragment),this.h()},l(u){e=I(u,"DIV",{class:!0});var b=B(e);N(t.$$.fragment,b),s=M(b),N(n.$$.fragment,b),a=M(b),N(r.$$.fragment,b),p=M(b),f=I(b,"DIV",{class:!0});var g=B(f);c&&c.l(g),D=M(g),N(i.$$.fragment,g),g.forEach(E),b.forEach(E),this.h()},h(){$(f,"class","main svelte-piryt3"),$(e,"class","container svelte-piryt3")},m(u,b){k(u,e,b),P(t,e,null),v(e,s),P(n,e,null),v(e,a),P(r,e,null),v(e,p),v(e,f),c&&c.m(f,null),v(f,D),P(i,f,null),o=!0},p(u,[b]){const g={};b&131&&(g.$$scope={dirty:b,ctx:u}),t.$set(g);const _={};n.$set(_);const x={};r.$set(x),c&&c.p&&(!o||b&128)&&ie(c,w,u,u[7],o?pe(w,u[7],b,null):ue(u[7]),null)},i(u){o||(L(t.$$.fragment,u),L(n.$$.fragment,u),L(r.$$.fragment,u),L(c,u),L(i.$$.fragment,u),o=!0)},o(u){j(t.$$.fragment,u),j(n.$$.fragment,u),j(r.$$.fragment,u),j(c,u),j(i.$$.fragment,u),o=!1},d(u){u&&E(e),X(t),l[5](null),X(n),l[6](null),X(r),c&&c.d(u),X(i)}}}function Xe(l,e,t){let{$$slots:s={},$$scope:n}=e,a,r;const p=()=>{var o;(o=a.exports.modal)==null||o.toggle()},f=()=>{var o;(o=r.exports.modal)==null||o.toggle()};function D(o){Y[o?"unshift":"push"](()=>{a=o,t(0,a)})}function i(o){Y[o?"unshift":"push"](()=>{r=o,t(1,r)})}return l.$$set=o=>{"$$scope"in o&&t(7,n=o.$$scope)},[a,r,s,p,f,D,i,n]}class Ge extends W{constructor(e){super(),q(this,e,Xe,Pe,G,{})}}export{Ge as component};
