import{a as z,j as te,o as se,C as B,d as O,r as ue,F as fe,c as ne,e as Z,u as ae,g as le,b as re,l as ce}from"../chunks/scheduler.Coouxh8L.js";import{S as G,i as W,c as P,d as j,m as y,t as R,l as N,n as H,e as D,s as A,a as k,b as X,q as F,f as E,g as w,h as p,j as S,k as v,r as Q,D as me,B as L,o as V,p as Y,x as pe}from"../chunks/index.CbAtjXu_.js";import{b as q}from"../chunks/paths.Dezj3jUE.js";import{D as ie}from"../chunks/Dialog.DkzHurqP.js";import{s as U,S as de}from"../chunks/store.DZb1jBln.js";import{T as ge,a as ee}from"../chunks/ToolbarItem.Bxe9aOjZ.js";import{a as he,b as $e}from"../chunks/imageUtils.DqVI_vGs.js";import{D as _e,P as ve}from"../chunks/DragDropUpload.C8zCghRk.js";function be(l){let e,t,a="Hex Count",s,n,r,c,u="X:",f,o,i,M,$,I,g,m="Y:",C,_,b,x,d;return{c(){e=D("div"),t=D("h1"),t.textContent=a,s=A(),n=D("br"),r=A(),c=D("label"),c.textContent=u,f=A(),o=D("input"),M=A(),$=D("br"),I=A(),g=D("label"),g.textContent=m,C=A(),_=D("input"),this.h()},l(h){e=k(h,"DIV",{class:!0});var T=X(e);t=k(T,"H1",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-c4bxn4"&&(t.textContent=a),s=E(T),n=k(T,"BR",{class:!0}),r=E(T),c=k(T,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),F(c)!=="svelte-vvw4xn"&&(c.textContent=u),f=E(T),o=k(T,"INPUT",{id:!0,name:!0,type:!0,min:!0,step:!0,class:!0}),M=E(T),$=k(T,"BR",{class:!0}),I=E(T),g=k(T,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),F(g)!=="svelte-tr29dr"&&(g.textContent=m),C=E(T),_=k(T,"INPUT",{id:!0,name:!0,type:!0,min:!0,step:!0,class:!0}),T.forEach(w),this.h()},h(){p(t,"class","svelte-m378fu"),p(n,"class","svelte-m378fu"),p(c,"for","hexesX"),p(c,"class","svelte-m378fu"),p(o,"id","hexesX"),p(o,"name","hexesX"),p(o,"type","number"),p(o,"min",1),p(o,"step",1),o.value=i=l[1].hexesX,p(o,"class","svelte-m378fu"),p($,"class","svelte-m378fu"),p(g,"for","hexesY"),p(g,"class","svelte-m378fu"),p(_,"id","hexesY"),p(_,"name","hexesY"),p(_,"type","number"),p(_,"min",1),p(_,"step",1),_.value=b=l[1].hexesY,p(_,"class","svelte-m378fu"),p(e,"class","dialog svelte-m378fu")},m(h,T){S(h,e,T),v(e,t),v(e,s),v(e,n),v(e,r),v(e,c),v(e,f),v(e,o),v(e,M),v(e,$),v(e,I),v(e,g),v(e,C),v(e,_),x||(d=[Q(o,"change",l[3]),Q(_,"change",l[4])],x=!0)},p(h,T){T&2&&i!==(i=h[1].hexesX)&&o.value!==i&&(o.value=i),T&2&&b!==(b=h[1].hexesY)&&_.value!==b&&(_.value=b)},d(h){h&&w(e),x=!1,ue(d)}}}function Ce(l){let e,t,a={$$slots:{default:[be]},$$scope:{ctx:l}};return e=new ie({props:a}),l[5](e),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,n){y(e,s,n),t=!0},p(s,[n]){const r={};n&130&&(r.$$scope={dirty:n,ctx:s}),e.$set(r)},i(s){t||(R(e.$$.fragment,s),t=!0)},o(s){N(e.$$.fragment,s),t=!1},d(s){l[5](null),H(e,s)}}}function xe(l,e,t){let a;te(l,U,o=>t(1,a=o));const s={modal:null};let n;const r={x:a.hexesX,y:a.hexesY};U.subscribe(({hexesX:o,hexesY:i})=>{a.viewport===null||r.x===o&&r.y===i||a.hexGridLayer.populate(a.mapDimensions,a.viewport,o,i)}),se(()=>{t(2,s.modal=n,s)});const c=o=>{const i=parseInt(o.currentTarget.value);B(U,a.hexesX=isNaN(i)?1:Math.max(Math.floor(i),1),a)},u=o=>{const i=parseInt(o.currentTarget.value);B(U,a.hexesY=isNaN(i)?1:Math.max(Math.floor(i),1),a)};function f(o){O[o?"unshift":"push"](()=>{n=o,t(0,n)})}return[n,a,s,c,u,f]}class Te extends G{constructor(e){super(),W(this,e,xe,Ce,z,{exports:2})}get exports(){return this.$$.ctx[2]}}function we(l){let e,t=`Drag and drop your .basis files here (in 1 go), or click to upload a
        file.`,a,s,n;return{c(){e=D("p"),e.textContent=t,a=A(),s=D("span"),n=V(l[1]),this.h()},l(r){e=k(r,"P",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-1isbihn"&&(e.textContent=t),a=E(r),s=k(r,"SPAN",{class:!0});var c=X(s);n=Y(c,l[1]),c.forEach(w),this.h()},h(){p(e,"class","svelte-13jdnn1"),p(s,"class","error svelte-13jdnn1")},m(r,c){S(r,e,c),S(r,a,c),S(r,s,c),v(s,n)},p(r,c){c&2&&pe(n,r[1])},d(r){r&&(w(e),w(a),w(s))}}}function Ie(l){let e,t,a="Upload Map Images",s,n,r="The map images must be in the format: tile_(x)_(y)@(1x OR 0.5x).basis",c,u,f="ie, tile_3_5@0.5x.basis",o,i,M,$,I,g,m;i=new _e({props:{mimeType:".basis",multiple:!0,onFileUpload:l[4],$$slots:{default:[we]},$$scope:{ctx:l}}});function C(b){l[6](b)}let _={containerStyles:{"border-color":"red"}};return l[2]!==void 0&&(_.value=l[2]),I=new ve({props:_}),O.push(()=>me(I,"value",C)),l[7](I),{c(){e=D("div"),t=D("h1"),t.textContent=a,s=A(),n=D("p"),n.textContent=r,c=A(),u=D("p"),u.textContent=f,o=A(),P(i.$$.fragment),M=A(),$=D("div"),P(I.$$.fragment),this.h()},l(b){e=k(b,"DIV",{class:!0});var x=X(e);t=k(x,"H1",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-d8o6tz"&&(t.textContent=a),s=E(x),n=k(x,"P",{class:!0,"data-svelte-h":!0}),F(n)!=="svelte-lya26t"&&(n.textContent=r),c=E(x),u=k(x,"P",{class:!0,"data-svelte-h":!0}),F(u)!=="svelte-1gtbz8v"&&(u.textContent=f),o=E(x),j(i.$$.fragment,x),M=E(x),$=k(x,"DIV",{class:!0});var d=X($);j(I.$$.fragment,d),d.forEach(w),x.forEach(w),this.h()},h(){p(t,"class","svelte-13jdnn1"),p(n,"class","svelte-13jdnn1"),p(u,"class","svelte-13jdnn1"),p($,"class","progress-bar svelte-13jdnn1"),L($,"hidden",l[2]===0),p(e,"class","dialog svelte-13jdnn1")},m(b,x){S(b,e,x),v(e,t),v(e,s),v(e,n),v(e,c),v(e,u),v(e,o),y(i,e,null),v(e,M),v(e,$),y(I,$,null),m=!0},p(b,x){const d={};x&1026&&(d.$$scope={dirty:x,ctx:b}),i.$set(d);const h={};!g&&x&4&&(g=!0,h.value=b[2],fe(()=>g=!1)),I.$set(h),(!m||x&4)&&L($,"hidden",b[2]===0)},i(b){m||(R(i.$$.fragment,b),R(I.$$.fragment,b),m=!0)},o(b){N(i.$$.fragment,b),N(I.$$.fragment,b),m=!1},d(b){b&&w(e),H(i),l[7](null),H(I)}}}function De(l){let e,t,a={$$slots:{default:[Ie]},$$scope:{ctx:l}};return e=new ie({props:a}),l[8](e),{c(){P(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,n){y(e,s,n),t=!0},p(s,[n]){const r={};n&1038&&(r.$$scope={dirty:n,ctx:s}),e.$set(r)},i(s){t||(R(e.$$.fragment,s),t=!0)},o(s){N(e.$$.fragment,s),t=!1},d(s){l[8](null),H(e,s)}}}const ke=/^tile_\d+_\d+@(1|0.5)x\.basis$/;function Ae(l,e,t){let a;te(l,U,$=>t(9,a=$));const s={modal:null};let n,r="",c=0,u;async function f($){var x;if(t(1,r=""),a.viewport===null){t(1,r="Error: App is not initialised. This shouldn't happen...");return}if($.length===0)return;const I=(x=$.find(d=>!ke.test(d.name)))==null?void 0:x.name;if(I!==void 0){t(1,r=`Invalid file name: ${I}`);return}const g=$.map(d=>{const h=d.name.slice(0,-7).split(/_|@/g),T=parseInt(h[1]),J=parseInt(h[2]),oe=parseInt(h[3]);return{x:T,y:J,resolution:oe}}),m=Math.max(...g.map(d=>d.x))+1,C=Math.max(...g.map(d=>d.y))+1;if(g.length!==m*C){const d=[];for(let h=0;h<m;h++)for(let T=0;T<C;T++)g.find(J=>J.x===h&&J.y===T)===void 0&&d.push({x:h,y:T});t(1,r=`Some tiles are missing. First, do you intend to have ${m}x${C} tiles? If so, then you are missing these tiles: ${d.map(h=>`(${h.x},${h.y})`).join(", ")}`);return}const _=await he($.map(d=>({file:d,name:d.name})),2,d=>{u.set(d)});B(U,a.mapDimensions={x:_.tileWidth*m,y:_.tileHeight*C},a);const b=_.tiles.map(d=>{const h=de.from($e(d.image));return h.x=d.x*_.tileWidth,h.y=d.y*_.tileHeight,h.cullable=!0,h.label=`Tile (${d.x}, ${d.y})`,h});a.viewport.children.forEach(d=>d.removeChildren().forEach(h=>h.destroy)),a.backgroundLayer.addChild(...b),B(U,a.viewport.worldWidth=a.mapDimensions.x,a),B(U,a.viewport.worldHeight=a.mapDimensions.y,a),a.viewport.centerViewport(),a.hexGridLayer.populate(a.mapDimensions,a.viewport,a.hexesX,a.hexesY)}se(()=>{t(5,s.modal=n,s)});function o($){c=$,t(2,c)}function i($){O[$?"unshift":"push"](()=>{u=$,t(3,u)})}function M($){O[$?"unshift":"push"](()=>{n=$,t(0,n)})}return[n,r,c,u,f,s,o,i,M]}class Ee extends G{constructor(e){super(),W(this,e,Ae,De,z,{exports:5})}get exports(){return this.$$.ctx[5]}}function Se(l){let e,t,a,s,n,r,c;const u=l[6].default,f=ne(u,l,l[5],null);return{c(){e=D("input"),a=A(),s=D("div"),f&&f.c(),this.h()},l(o){e=k(o,"INPUT",{type:!0,src:!0,alt:!0,class:!0}),a=E(o),s=k(o,"DIV",{class:!0});var i=X(s);f&&f.l(i),i.forEach(w),this.h()},h(){p(e,"type","image"),Z(e.src,t=l[0])||p(e,"src",t),p(e,"alt",l[1]),p(e,"class","svelte-q18i79"),L(e,"active",l[4]===l[2]),p(s,"class","svelte-q18i79"),L(s,"hidden",l[4]!==l[2])},m(o,i){S(o,e,i),S(o,a,i),S(o,s,i),f&&f.m(s,null),n=!0,r||(c=Q(e,"click",l[7]),r=!0)},p(o,[i]){(!n||i&1&&!Z(e.src,t=o[0]))&&p(e,"src",t),(!n||i&2)&&p(e,"alt",o[1]),(!n||i&20)&&L(e,"active",o[4]===o[2]),f&&f.p&&(!n||i&32)&&ae(f,u,o,o[5],n?re(u,o[5],i,null):le(o[5]),null),(!n||i&20)&&L(s,"hidden",o[4]!==o[2])},i(o){n||(R(f,o),n=!0)},o(o){N(f,o),n=!1},d(o){o&&(w(e),w(a),w(s)),f&&f.d(o),r=!1,c()}}}let Me=0;function Re(){return Me++}function Ne(l,e,t){let{$$slots:a={},$$scope:s}=e,{imageSRC:n}=e,{imageAltText:r}=e,{activeTab:c}=e,{iconOnClick:u=()=>{}}=e;const f=Re(),o=()=>u(f);return l.$$set=i=>{"imageSRC"in i&&t(0,n=i.imageSRC),"imageAltText"in i&&t(1,r=i.imageAltText),"activeTab"in i&&t(2,c=i.activeTab),"iconOnClick"in i&&t(3,u=i.iconOnClick),"$$scope"in i&&t(5,s=i.$$scope)},[n,r,c,u,f,s,a,o]}class K extends G{constructor(e){super(),W(this,e,Ne,Se,z,{imageSRC:0,imageAltText:1,activeTab:2,iconOnClick:3,id:4})}get id(){return this.$$.ctx[4]}}function Pe(l){let e;return{c(){e=V("1")},l(t){e=Y(t,"1")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function je(l){let e;return{c(){e=V("2")},l(t){e=Y(t,"2")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function ye(l){let e;return{c(){e=V("3")},l(t){e=Y(t,"3")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function He(l){let e,t,a,s,n,r,c;return t=new K({props:{imageSRC:q+"/hex_grid.png",imageAltText:"",activeTab:l[2],iconOnClick:l[3],$$slots:{default:[Pe]},$$scope:{ctx:l}}}),s=new K({props:{imageSRC:q+"/hex_grid.png",imageAltText:"",activeTab:l[2],iconOnClick:l[3],$$slots:{default:[je]},$$scope:{ctx:l}}}),r=new K({props:{imageSRC:q+"/hex_grid.png",imageAltText:"",activeTab:l[2],iconOnClick:l[3],$$slots:{default:[ye]},$$scope:{ctx:l}}}),{c(){e=D("div"),P(t.$$.fragment),a=A(),P(s.$$.fragment),n=A(),P(r.$$.fragment),this.h()},l(u){e=k(u,"DIV",{class:!0});var f=X(e);j(t.$$.fragment,f),a=E(f),j(s.$$.fragment,f),n=E(f),j(r.$$.fragment,f),f.forEach(w),this.h()},h(){p(e,"class","container svelte-1tcz0e6"),L(e,"hidden",l[0])},m(u,f){S(u,e,f),y(t,e,null),v(e,a),y(s,e,null),v(e,n),y(r,e,null),l[4](e),c=!0},p(u,[f]){const o={};f&4&&(o.activeTab=u[2]),f&32&&(o.$$scope={dirty:f,ctx:u}),t.$set(o);const i={};f&4&&(i.activeTab=u[2]),f&32&&(i.$$scope={dirty:f,ctx:u}),s.$set(i);const M={};f&4&&(M.activeTab=u[2]),f&32&&(M.$$scope={dirty:f,ctx:u}),r.$set(M),(!c||f&1)&&L(e,"hidden",u[0])},i(u){c||(R(t.$$.fragment,u),R(s.$$.fragment,u),R(r.$$.fragment,u),c=!0)},o(u){N(t.$$.fragment,u),N(s.$$.fragment,u),N(r.$$.fragment,u),c=!1},d(u){u&&w(e),H(t),H(s),H(r),l[4](null)}}}function Le(l,e,t){let{hidden:a=!1}=e,s,n=0;function r(u){t(2,n=u)}function c(u){O[u?"unshift":"push"](()=>{s=u,t(1,s)})}return l.$$set=u=>{"hidden"in u&&t(0,a=u.hidden)},[a,s,n,r,c]}class Ue extends G{constructor(e){super(),W(this,e,Le,He,z,{hidden:0})}get hidden(){return this.$$.ctx[0]}set hidden(e){this.$$set({hidden:e}),ce()}}function Xe(l){let e;return{c(){e=V("Upload Map Images")},l(t){e=Y(t,"Upload Map Images")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function Fe(l){let e;return{c(){e=V("Hexes")},l(t){e=Y(t,"Hexes")},m(t,a){S(t,e,a)},d(t){t&&w(e)}}}function Oe(l){let e,t,a,s;return e=new ee({props:{imageSRC:q+"/upload.png",imageAltText:"An upload icon",onClick:l[3],$$slots:{default:[Xe]},$$scope:{ctx:l}}}),a=new ee({props:{imageSRC:q+"/hex_grid.png",imageAltText:"A honeycomb",onClick:l[4],$$slots:{default:[Fe]},$$scope:{ctx:l}}}),{c(){P(e.$$.fragment),t=A(),P(a.$$.fragment)},l(n){j(e.$$.fragment,n),t=E(n),j(a.$$.fragment,n)},m(n,r){y(e,n,r),S(n,t,r),y(a,n,r),s=!0},p(n,r){const c={};r&1&&(c.onClick=n[3]),r&128&&(c.$$scope={dirty:r,ctx:n}),e.$set(c);const u={};r&2&&(u.onClick=n[4]),r&128&&(u.$$scope={dirty:r,ctx:n}),a.$set(u)},i(n){s||(R(e.$$.fragment,n),R(a.$$.fragment,n),s=!0)},o(n){N(e.$$.fragment,n),N(a.$$.fragment,n),s=!1},d(n){n&&w(t),H(e,n),H(a,n)}}}function Ve(l){let e,t,a,s,n,r,c,u,f,o,i;t=new ge({props:{$$slots:{default:[Oe]},$$scope:{ctx:l}}});let M={};s=new Ee({props:M}),l[5](s);let $={};r=new Te({props:$}),l[6](r);const I=l[2].default,g=ne(I,l,l[7],null);return o=new Ue({}),{c(){e=D("div"),P(t.$$.fragment),a=A(),P(s.$$.fragment),n=A(),P(r.$$.fragment),c=A(),u=D("div"),g&&g.c(),f=A(),P(o.$$.fragment),this.h()},l(m){e=k(m,"DIV",{class:!0});var C=X(e);j(t.$$.fragment,C),a=E(C),j(s.$$.fragment,C),n=E(C),j(r.$$.fragment,C),c=E(C),u=k(C,"DIV",{class:!0});var _=X(u);g&&g.l(_),f=E(_),j(o.$$.fragment,_),_.forEach(w),C.forEach(w),this.h()},h(){p(u,"class","main svelte-piryt3"),p(e,"class","container svelte-piryt3")},m(m,C){S(m,e,C),y(t,e,null),v(e,a),y(s,e,null),v(e,n),y(r,e,null),v(e,c),v(e,u),g&&g.m(u,null),v(u,f),y(o,u,null),i=!0},p(m,[C]){const _={};C&131&&(_.$$scope={dirty:C,ctx:m}),t.$set(_);const b={};s.$set(b);const x={};r.$set(x),g&&g.p&&(!i||C&128)&&ae(g,I,m,m[7],i?re(I,m[7],C,null):le(m[7]),null)},i(m){i||(R(t.$$.fragment,m),R(s.$$.fragment,m),R(r.$$.fragment,m),R(g,m),R(o.$$.fragment,m),i=!0)},o(m){N(t.$$.fragment,m),N(s.$$.fragment,m),N(r.$$.fragment,m),N(g,m),N(o.$$.fragment,m),i=!1},d(m){m&&w(e),H(t),l[5](null),H(s),l[6](null),H(r),g&&g.d(m),H(o)}}}function Ye(l,e,t){let{$$slots:a={},$$scope:s}=e,n,r;const c=()=>{var i;(i=n.exports.modal)==null||i.toggle()},u=()=>{var i;(i=r.exports.modal)==null||i.toggle()};function f(i){O[i?"unshift":"push"](()=>{n=i,t(0,n)})}function o(i){O[i?"unshift":"push"](()=>{r=i,t(1,r)})}return l.$$set=i=>{"$$scope"in i&&t(7,s=i.$$scope)},[n,r,a,c,u,f,o,s]}class Ze extends G{constructor(e){super(),W(this,e,Ye,Ve,z,{})}}export{Ze as component};
